/*! starrating - v1.1 - 2013-07-15 11:58:06 AM
* Copyright (c) 2013 乔花; Licensed  */
KISSY.add("gallery/starrating/1.1/starrating",function(a){function b(){b.superclass.constructor.apply(this,arguments),this._init()}var c=".",d="";return b.ATTRS={container:{setter:function(b){return a.isString(b)?a.one(b):b.offset?b:new a.Node(b)}},reason:{value:[]},level:{value:[]},tipsCls:{value:"rating-tips"},itemCls:{value:"shop-rating"},popCls:{value:"rating-pop-tip"},currentCls:{value:"current-rating"},resultCls:{value:"result"},valueName:{value:"data-star-value"}},a.extend(b,a.Base,{_init:function(){var b=this,e=b.get("container");if(e){var f=b.get("reason"),g=b.get("level"),h=b.get("currentCls");e.all(c+b.get("itemCls")).each(function(i,j){f[j]||(f[j]=[]),i.all("a").each(function(k,l){f[j][l]=f[j][l]||d,g[l]=g[l]||d;var m=k.attr(b.get("valueName")),n=f[j][l];k.on("click",function(a){a.halt(),i.all(c+h).removeClass(h),k.addClass(h),e.all(c+b.get("tipsCls")).hide(),i.one("input").val(m),i.one(c+b.get("resultCls")).html("<span><em>"+m+"</em> \u5206</span> - <strong>"+n+"</strong>"),b.fire("rating",{idx:j,score:m})}).on("mouseenter",function(d){var f=new a.Node(d.currentTarget),h=f.offset(),i=e.offset();e.all(c+b.get("popCls")).html("<span><em>"+m+"</em> \u5206 "+g[l]+"</span><strong>"+n+"</strong>").css({left:h.left+f.width()-i.left-100+"px",top:h.top-i.top+f.height()+"px"}).show()}).on("mouseleave",function(){e.all(c+b.get("popCls")).hide()});try{6===a.UA.ie&&k.parent().addClass(k.attr("class").split()[0])}catch(o){}})})}}}),b}),KISSY.add("gallery/starrating/1.1/index",function(a,b){return b},{requires:["./starrating"]});